//================== SysCAD - Copyright Kenwalt (Pty) Ltd ===================
// $Nokeywords: $
//===========================================================================
/* -3 */
/*********************************** C3B.C *********************************/
/********************** Three-dimensional Bezier curves ********************/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                          !!!!!!!*/
/*!!!!!!!!(C) Copyright 1989, 1990, 1991 Building Block Software!!!!!!!!*/
/*!!!!!!!!                    All rights reserved                   !!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/

#ifdef  SPLINE
#include <aladefs.h>
#include <albdefs.h>
#include <c3bdefs.h>
#include <c3vmcrs.h>

/*-------------------------------------------------------------------------*/
BBS_PRIVATE void c3b_dot ( b1, d1, b2, d2, b ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                          !!!!!!!*/
/*!!!!!!!!(C) Copyright 1989, 1990, 1991 Building Block Software!!!!!!!!*/
/*!!!!!!!!                    All rights reserved                   !!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/

HPT3 *b1 , *b2  ;
HREAL *b  ;
INT d1, d2 ;
{
    INT i, j, k, d=d1+d2-1 ;
    REAL w, *c, *c1, *c3, *c0 ;

    c = CREATE ( d*d, REAL ) ;
    if ( c== NULL ) 
        RETURN ;
    ala_binom ( d, c ) ;
    c1 = c + d * (d1-1) ;
    c3 = c + d * (d2-1) ;
    c0 = c + d * (d-1) ;

    for ( k=0 ; k<d ; k++ ) {
        b[k][0] = 0.0 ;
        b[k][1] = 0.0 ;
    }
    
    for ( i=0 ; i<d1 ; i++ )
        for ( j=0 ; j<d2 ; j++ ) {
            w = c1[i] * c3[j] ;
            b[i+j][0] += ( w * C3V_DOT ( b1[i], b2[j] ) ) ;
            b[i+j][1] += ( w * b1[i][3] * b2[j][3] ) ;
        }
    for ( k=0 ; k<d ; k++ ) {
        b[k][0] /= (c0[k]) ;
        b[k][1] /= (c0[k]) ;
    }
    KILL ( c ) ;
}


/*-------------------------------------------------------------------------*/
BBS_PRIVATE void c3b_brk0 ( a, d, t, b ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                         !!!!!!!!*/
/*!!!!!!!!(C) Copyright 1989, 1990, 1991 Building Block Software!!!!!!!!*/
/*!!!!!!!!                    All rights reserved                  !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
HPT3    *a  ; 
INT     d   ;   /* order of the Bezier */
REAL    t   ;   /* break parameter */
HPT3    *b  ;   /* b[d] - subdivision */
{ 
    alb_brk0 ( (REAL*)a, d, 4, t, (REAL*)b ) ;
}


/*-------------------------------------------------------------------------*/
BBS_PRIVATE void c3b_brkl ( a, d, t, b ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                         !!!!!!!!*/
/*!!!!!!!!(C) Copyright 1989, 1990, 1991 Building Block Software!!!!!!!!*/
/*!!!!!!!!                    All rights reserved                  !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
HPT3    *a  ; 
INT     d   ;   /* order of the Bezier */
REAL    t   ;   /* break parameter */
HPT3    *b  ;   /* b[d] - subdivision */
{ 
    alb_brkl ( (REAL*)a, d, 4, t, (REAL*)b ) ;
}


/*-------------------------------------------------------------------------*/
BBS_PRIVATE void c3b_brkr ( a, d, t, b ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                         !!!!!!!!*/
/*!!!!!!!!(C) Copyright 1989, 1990, 1991 Building Block Software!!!!!!!!*/
/*!!!!!!!!                    All rights reserved                  !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
HPT3    *a  ; 
INT     d   ;   /* order of the Bezier */
REAL    t   ;   /* break parameter */
HPT3    *b  ;   /* b[d] - subdivision */
{ 
    alb_brkr ( (REAL*)a, d, 4, t, (REAL*)b ) ;
}


/*-------------------------------------------------------------------------*/
BBS_PRIVATE void c3b_sbdv0 ( a, d, b ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                         !!!!!!!!*/
/*!!!!!!!!(C) Copyright 1989, 1990, 1991 Building Block Software!!!!!!!!*/
/*!!!!!!!!                    All rights reserved                  !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
HPT3    *a  ; 
INT     d   ;   /* order of the Bezier */
HPT3    *b  ;   /* b[d] - subdivision */
{ 
    alb_sbdv0 ( (REAL*)a, d, 4, (REAL*)b ) ;
}

#endif  /*SPLINE*/


